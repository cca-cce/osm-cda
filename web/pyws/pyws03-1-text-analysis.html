<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>reading text content – osm-pyws</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pyws01-0-getting-started.html">workshop</a></li><li class="breadcrumb-item"><a href="./pyws03-0-text-analysis.html">part 3: text analysis</a></li><li class="breadcrumb-item"><a href="./pyws03-1-text-analysis.html">reading text content</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">osm-pyws</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">start</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">about</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">workshop</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pyws01-0-getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">part 1: getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws01-1-getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">python environments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws01-2-getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">basic python syntax</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pyws02-0-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">part 2: data analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws02-1-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">dataframe manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws02-2-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">result visualizations</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pyws03-0-text-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">part 3: text analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws03-1-text-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">reading text content</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws03-2-text-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">text tokenization</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pyws04-0-image-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">part 4: image analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws04-1-image-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">reading image content</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws04-2-image-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">object recognition</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pyws05-0-data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">part 5: data collection</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws05-1-data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">web scraping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyws05-2-data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">web experiments</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">resources</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#recap-reading-data-files" id="toc-recap-reading-data-files" class="nav-link active" data-scroll-target="#recap-reading-data-files">recap reading data files</a></li>
  <li><a href="#nltk-and-text-corpora" id="toc-nltk-and-text-corpora" class="nav-link" data-scroll-target="#nltk-and-text-corpora">nltk and text corpora</a>
  <ul class="collapse">
  <li><a href="#import-libraries-and-download-nltk-data" id="toc-import-libraries-and-download-nltk-data" class="nav-link" data-scroll-target="#import-libraries-and-download-nltk-data">Import Libraries and Download NLTK Data</a></li>
  <li><a href="#load-the-gutenberg-corpus" id="toc-load-the-gutenberg-corpus" class="nav-link" data-scroll-target="#load-the-gutenberg-corpus">Load the Gutenberg Corpus</a></li>
  <li><a href="#analyze-each-text-in-the-corpus" id="toc-analyze-each-text-in-the-corpus" class="nav-link" data-scroll-target="#analyze-each-text-in-the-corpus">Analyze Each Text in the Corpus</a></li>
  <li><a href="#create-and-display-the-dataframe" id="toc-create-and-display-the-dataframe" class="nav-link" data-scroll-target="#create-and-display-the-dataframe">Create and Display the DataFrame</a></li>
  <li><a href="#set-up-the-output-directory" id="toc-set-up-the-output-directory" class="nav-link" data-scroll-target="#set-up-the-output-directory">Set Up the Output Directory</a></li>
  <li><a href="#generate-and-display-plots" id="toc-generate-and-display-plots" class="nav-link" data-scroll-target="#generate-and-display-plots">Generate and Display Plots</a></li>
  <li><a href="#save-texts-to-disk" id="toc-save-texts-to-disk" class="nav-link" data-scroll-target="#save-texts-to-disk">Save Texts to Disk</a></li>
  <li><a href="#load-saved-texts-into-an-nltk-corpus" id="toc-load-saved-texts-into-an-nltk-corpus" class="nav-link" data-scroll-target="#load-saved-texts-into-an-nltk-corpus">Load Saved Texts into an NLTK Corpus</a></li>
  </ul></li>
  <li><a href="#text-to-pandas-dataframe" id="toc-text-to-pandas-dataframe" class="nav-link" data-scroll-target="#text-to-pandas-dataframe">text to pandas dataframe</a>
  <ul class="collapse">
  <li><a href="#import-libraries-and-define-text-cleaning-function" id="toc-import-libraries-and-define-text-cleaning-function" class="nav-link" data-scroll-target="#import-libraries-and-define-text-cleaning-function">Import Libraries and Define Text Cleaning Function</a></li>
  <li><a href="#set-directory-paths-and-initialize-data-structures" id="toc-set-directory-paths-and-initialize-data-structures" class="nav-link" data-scroll-target="#set-directory-paths-and-initialize-data-structures">Set Directory Paths and Initialize Data Structures</a></li>
  <li><a href="#read-and-clean-text-files" id="toc-read-and-clean-text-files" class="nav-link" data-scroll-target="#read-and-clean-text-files">Read and Clean Text Files</a></li>
  <li><a href="#create-and-save-dataframe" id="toc-create-and-save-dataframe" class="nav-link" data-scroll-target="#create-and-save-dataframe">Create and Save DataFrame</a></li>
  <li><a href="#load-spacy-model" id="toc-load-spacy-model" class="nav-link" data-scroll-target="#load-spacy-model">Load spaCy Model</a></li>
  <li><a href="#compute-text-statistics" id="toc-compute-text-statistics" class="nav-link" data-scroll-target="#compute-text-statistics">Compute Text Statistics</a></li>
  <li><a href="#display-dataframe-with-selected-columns" id="toc-display-dataframe-with-selected-columns" class="nav-link" data-scroll-target="#display-dataframe-with-selected-columns">Display DataFrame with Selected Columns</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pyws01-0-getting-started.html">workshop</a></li><li class="breadcrumb-item"><a href="./pyws03-0-text-analysis.html">part 3: text analysis</a></li><li class="breadcrumb-item"><a href="./pyws03-1-text-analysis.html">reading text content</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">reading text content</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<ul>
<li>code examples <a href="https://www.nltk.org/howto.html">nltk</a></li>
<li>code examples <a href="https://spacy.io/usage/spacy-101">spacy</a></li>
<li>download <a href="pyws03-1-text-analysis.ipynb">jupyter notebook</a></li>
</ul>
<div id="850409ce" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run inside google colab</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!git clone https://github.com/cca-cce/osm-cca-nlp.git</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="recap-reading-data-files" class="level2">
<h2 class="anchored" data-anchor-id="recap-reading-data-files">recap reading data files</h2>
<div id="b5b8210c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># comma separated</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'users.csv'</span>, sep<span class="op">=</span><span class="st">','</span>, quotechar<span class="op">=</span><span class="st">'"'</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.csv', sep=',', quotechar='"', header=None)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.csv', sep=',', quotechar="'", header=0)</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.csv', sep=',', quotechar="'", header=None)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.csv', sep='\t', quotechar='"', header=0)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.csv', sep='\t', quotechar='"', header=None)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.csv', sep='\t', quotechar="'", header=0)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.csv', sep='\t', quotechar="'", header=None)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># tab separated </span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.tsv', sep=',', quotechar='"', header=0)</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.tsv', sep=',', quotechar='"', header=None)</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.tsv', sep=',', quotechar="'", header=0)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.tsv', sep=',', quotechar="'", header=None)</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'users.tsv'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, quotechar<span class="op">=</span><span class="st">'"'</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.tsv', sep='\t', quotechar='"', header=None)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.tsv', sep='\t', quotechar="'", header=0)</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_csv('users.tsv', sep='\t', quotechar="'", header=None)</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># excel</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_excel('users.xlsx', header=0, sheet_name=1)</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#df = pd.read_excel('users.xlsx', header=None, sheet_name=1)</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="nltk-and-text-corpora" class="level2">
<h2 class="anchored" data-anchor-id="nltk-and-text-corpora">nltk and text corpora</h2>
<section id="import-libraries-and-download-nltk-data" class="level3">
<h3 class="anchored" data-anchor-id="import-libraries-and-download-nltk-data">Import Libraries and Download NLTK Data</h3>
<p><em>In this step, we import the necessary libraries and download the required NLTK data packages. Specifically, we use NLTK’s <code>download</code> function to ensure the ‘gutenberg’ corpus and the ‘punkt’ tokenizer are available for use. The ‘punkt’ tokenizer is essential for splitting text into sentences and words.</em></p>
<div id="3996d3a5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Download necessary NLTK data files</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'gutenberg'</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'punkt'</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'punkt_tab'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="load-the-gutenberg-corpus" class="level3">
<h3 class="anchored" data-anchor-id="load-the-gutenberg-corpus">Load the Gutenberg Corpus</h3>
<p><em>Here, we import the Gutenberg corpus from NLTK’s corpus module. The Gutenberg corpus is a collection of literary texts that we will analyze. We retrieve the list of file IDs available in the corpus using <code>gutenberg.fileids()</code>, which provides us with the filenames of the texts in the corpus.</em></p>
<div id="512143db" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> gutenberg</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of file IDs from the Gutenberg corpus</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>file_ids <span class="op">=</span> gutenberg.fileids()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="analyze-each-text-in-the-corpus" class="level3">
<h3 class="anchored" data-anchor-id="analyze-each-text-in-the-corpus">Analyze Each Text in the Corpus</h3>
<p><em>In this section, we iterate over each text in the Gutenberg corpus to compute various linguistic statistics. We use NLTK’s <code>raw()</code> method to get the raw text, <code>word_tokenize()</code> to split the text into words, and <code>sent_tokenize()</code> to split the text into sentences. These NLTK tokenizers are essential for textual analysis.</em></p>
<div id="283a07d8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store statistics</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>stats_list <span class="op">=</span> []</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze each text in the corpus</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> file_id <span class="kw">in</span> file_ids:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    raw_text <span class="op">=</span> gutenberg.raw(file_id)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> nltk.word_tokenize(raw_text)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    sentences <span class="op">=</span> nltk.sent_tokenize(raw_text)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    num_words <span class="op">=</span> <span class="bu">len</span>(words)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    num_sentences <span class="op">=</span> <span class="bu">len</span>(sentences)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    avg_word_length <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">len</span>(word) <span class="cf">for</span> word <span class="kw">in</span> words) <span class="op">/</span> num_words</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    vocab_size <span class="op">=</span> <span class="bu">len</span>(<span class="bu">set</span>(words))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    lexical_diversity <span class="op">=</span> vocab_size <span class="op">/</span> num_words</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    stats_list.append({</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Title'</span>: file_id,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Num_Words'</span>: num_words,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Num_Sentences'</span>: num_sentences,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Avg_Word_Length'</span>: avg_word_length,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Vocab_Size'</span>: vocab_size,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Lexical_Diversity'</span>: lexical_diversity</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-and-display-the-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="create-and-display-the-dataframe">Create and Display the DataFrame</h3>
<p><em>We create a pandas DataFrame from the collected statistics for easier analysis and display it within the notebook using <code>display()</code>. This allows us to view the computed statistics in a structured tabular format.</em></p>
<div id="5062aaa9" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame to hold the statistics</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>stats_df <span class="op">=</span> pd.DataFrame(stats_list)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the statistics table</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>display(stats_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">Num_Words</th>
<th data-quarto-table-cell-role="th">Num_Sentences</th>
<th data-quarto-table-cell-role="th">Avg_Word_Length</th>
<th data-quarto-table-cell-role="th">Vocab_Size</th>
<th data-quarto-table-cell-role="th">Lexical_Diversity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>austen-emma.txt</td>
<td>191855</td>
<td>7493</td>
<td>3.788288</td>
<td>8376</td>
<td>0.043658</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>austen-persuasion.txt</td>
<td>97940</td>
<td>3654</td>
<td>3.896130</td>
<td>6218</td>
<td>0.063488</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>austen-sense.txt</td>
<td>141440</td>
<td>4833</td>
<td>3.906908</td>
<td>7078</td>
<td>0.050042</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>bible-kjv.txt</td>
<td>947008</td>
<td>29812</td>
<td>3.679540</td>
<td>18120</td>
<td>0.019134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>blake-poems.txt</td>
<td>8239</td>
<td>355</td>
<td>3.562690</td>
<td>1815</td>
<td>0.220294</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>bryant-stories.txt</td>
<td>55649</td>
<td>2715</td>
<td>3.526982</td>
<td>4460</td>
<td>0.080145</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>burgess-busterbrown.txt</td>
<td>18571</td>
<td>1001</td>
<td>3.608906</td>
<td>1739</td>
<td>0.093641</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>carroll-alice.txt</td>
<td>33535</td>
<td>1625</td>
<td>3.462711</td>
<td>3157</td>
<td>0.094140</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>chesterton-ball.txt</td>
<td>97277</td>
<td>4624</td>
<td>3.849430</td>
<td>9050</td>
<td>0.093033</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>chesterton-brown.txt</td>
<td>85489</td>
<td>3712</td>
<td>3.849747</td>
<td>8482</td>
<td>0.099217</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>chesterton-thursday.txt</td>
<td>69443</td>
<td>3588</td>
<td>3.800081</td>
<td>6916</td>
<td>0.099592</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>edgeworth-parents.txt</td>
<td>209310</td>
<td>10096</td>
<td>3.568989</td>
<td>9845</td>
<td>0.047035</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>melville-moby_dick.txt</td>
<td>255222</td>
<td>9852</td>
<td>3.926444</td>
<td>20639</td>
<td>0.080867</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>milton-paradise.txt</td>
<td>95716</td>
<td>1835</td>
<td>3.932947</td>
<td>10986</td>
<td>0.114777</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>shakespeare-caesar.txt</td>
<td>25277</td>
<td>1592</td>
<td>3.519880</td>
<td>3601</td>
<td>0.142462</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>shakespeare-hamlet.txt</td>
<td>36411</td>
<td>2355</td>
<td>3.554008</td>
<td>5515</td>
<td>0.151465</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>shakespeare-macbeth.txt</td>
<td>22274</td>
<td>1465</td>
<td>3.600072</td>
<td>4076</td>
<td>0.182994</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>whitman-leaves.txt</td>
<td>149249</td>
<td>3827</td>
<td>3.835972</td>
<td>15552</td>
<td>0.104202</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="set-up-the-output-directory" class="level3">
<h3 class="anchored" data-anchor-id="set-up-the-output-directory">Set Up the Output Directory</h3>
<p><em>Here, we define the output path where we’ll save the text files and figures. We use <code>os.makedirs()</code> with <code>exist_ok=True</code> to create the directory if it doesn’t already exist, ensuring that our output files have a designated location.</em></p>
<div id="fa97f8e8" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the output path for saving text files and figures</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>output_path <span class="op">=</span> <span class="st">"/home/sol-nhl/rnd/d/quarto/osm-cca-nlp/tmp"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the output directory if it doesn't exist</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>os.makedirs(output_path, exist_ok<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generate-and-display-plots" class="level3">
<h3 class="anchored" data-anchor-id="generate-and-display-plots">Generate and Display Plots</h3>
<p><em>In this step, we create various plots to visualize the text statistics using Seaborn and Matplotlib. We display these plots inline in the notebook using <code>plt.show()</code>. The plots include:</em></p>
<ul>
<li><em>A bar plot of the number of words per text.</em></li>
<li><em>A bar plot of the average word length per text.</em></li>
<li><em>A scatter plot of vocabulary size versus the number of words.</em></li>
</ul>
<p><em>We utilize NLTK’s tokenization outputs to extract the necessary values for plotting.</em></p>
<div id="09e8a58e" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up seaborn style</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'whitegrid'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot of number of words per text</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'Title'</span>, y<span class="op">=</span><span class="st">'Num_Words'</span>, data<span class="op">=</span>stats_df)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Number of Words per Text'</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>plt.savefig(os.path.join(output_path, <span class="st">'num_words_per_text.png'</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot of average word length per text</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'Title'</span>, y<span class="op">=</span><span class="st">'Avg_Word_Length'</span>, data<span class="op">=</span>stats_df)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Average Word Length per Text'</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>plt.savefig(os.path.join(output_path, <span class="st">'avg_word_length_per_text.png'</span>))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of vocabulary size vs. number of words</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'Num_Words'</span>, y<span class="op">=</span><span class="st">'Vocab_Size'</span>, data<span class="op">=</span>stats_df, hue<span class="op">=</span><span class="st">'Title'</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Vocabulary Size vs. Number of Words'</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>plt.savefig(os.path.join(output_path, <span class="st">'vocab_size_vs_num_words.png'</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="pyws03-1-text-analysis_files/figure-html/cell-9-output-1.png" width="942" height="560" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="pyws03-1-text-analysis_files/figure-html/cell-9-output-2.png" width="941" height="560" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="pyws03-1-text-analysis_files/figure-html/cell-9-output-3.png" width="944" height="559" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="save-texts-to-disk" class="level3">
<h3 class="anchored" data-anchor-id="save-texts-to-disk">Save Texts to Disk</h3>
<p><em>Finally, we save each text from the Gutenberg corpus as a plain text file to the specified output directory. We use NLTK’s <code>raw()</code> method again to retrieve the full text of each file and write it to disk using standard file I/O operations.</em></p>
<div id="d9d3f263" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save each text as a plain text file to the output path</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> file_id <span class="kw">in</span> file_ids:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    raw_text <span class="op">=</span> gutenberg.raw(file_id)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    output_file_path <span class="op">=</span> os.path.join(output_path, file_id)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(output_file_path, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        f.write(raw_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-saved-texts-into-an-nltk-corpus" class="level3">
<h3 class="anchored" data-anchor-id="load-saved-texts-into-an-nltk-corpus">Load Saved Texts into an NLTK Corpus</h3>
<p><em>In this final step, we read the saved texts from the output directory back into an NLTK corpus using <code>PlaintextCorpusReader</code>. This allows us to treat the collection of saved texts as a corpus for further analysis. <code>PlaintextCorpusReader</code> is an NLTK class designed to read plain text files from a directory and create a corpus object.</em></p>
<div id="892c5e2b" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> PlaintextCorpusReader</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the corpus root directory</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>corpus_root <span class="op">=</span> output_path</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the pattern to match the text files (e.g., all files with .txt extension)</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>file_pattern <span class="op">=</span> <span class="st">'.*'</span>  <span class="co"># Matches all files</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Matches only text files</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>file_pattern <span class="op">=</span> <span class="vs">r'.*\.txt'</span>  <span class="co"># Matches all files ending with .txt</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a PlaintextCorpusReader object</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>new_corpus <span class="op">=</span> PlaintextCorpusReader(corpus_root, file_pattern)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the file IDs in the new corpus</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>new_file_ids <span class="op">=</span> new_corpus.fileids()</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Files in the new corpus:"</span>, new_file_ids)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Read words from a specific file</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>words_in_file <span class="op">=</span> new_corpus.words(new_file_ids[<span class="dv">0</span>])</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First 20 words in"</span>, new_file_ids[<span class="dv">0</span>], <span class="st">":"</span>, words_in_file[:<span class="dv">20</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Files in the new corpus: ['austen-emma.txt', 'austen-persuasion.txt', 'austen-sense.txt', 'bible-kjv.txt', 'blake-poems.txt', 'bryant-stories.txt', 'burgess-busterbrown.txt', 'carroll-alice.txt', 'chesterton-ball.txt', 'chesterton-brown.txt', 'chesterton-thursday.txt', 'edgeworth-parents.txt', 'melville-moby_dick.txt', 'milton-paradise.txt', 'shakespeare-caesar.txt', 'shakespeare-hamlet.txt', 'shakespeare-macbeth.txt', 'whitman-leaves.txt']
First 20 words in austen-emma.txt : ['[', 'Emma', 'by', 'Jane', 'Austen', '1816', ']', 'VOLUME', 'I', 'CHAPTER', 'I', 'Emma', 'Woodhouse', ',', 'handsome', ',', 'clever', ',', 'and', 'rich']</code></pre>
</div>
</div>
<p><em>By using <code>PlaintextCorpusReader</code>, we can load all the saved text files into a new NLTK corpus. The <code>fileids()</code> method lists all the files in the corpus, and methods like <code>words()</code>, <code>sents()</code>, and <code>paras()</code> allow us to access words, sentences, and paragraphs, respectively. This demonstrates NLTK’s capability to handle custom corpora built from local text files, enabling further text processing and analysis on the newly created corpus.</em></p>
</section>
</section>
<section id="text-to-pandas-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="text-to-pandas-dataframe">text to pandas dataframe</h2>
<ul>
<li>example <a href="https://www.lunduniversity.lu.se/about-university/university-glance/mission-vision-and-values/sustainability">sustainability communication</a></li>
</ul>
<section id="import-libraries-and-define-text-cleaning-function" class="level3">
<h3 class="anchored" data-anchor-id="import-libraries-and-define-text-cleaning-function">Import Libraries and Define Text Cleaning Function</h3>
<p><em>In this step, we import the necessary libraries and define a function to clean text data. We use the <code>os</code> module for file and directory operations, <code>re</code> for regular expressions, <code>pandas</code> for data manipulation, and <code>spacy</code> for natural language processing tasks.</em></p>
<div id="8a4176e3" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python <span class="op">-</span>m spacy download en_core_web_sm</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to clean text by removing non-ASCII characters</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_text(text):</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove non-ASCII characters (commented out to preserve UTF-8 text)</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cleaned_text = re.sub(r'[^\x00-\x7F]+', '', text)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    cleaned_text <span class="op">=</span> text</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cleaned_text</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>The <code>clean_text</code> function is intended to remove non-ASCII characters using <code>re.sub</code>. However, since we are dealing with UTF-8 encoded text (e.g., Swedish text data), we retain the original text by commenting out the removal line.</em></p>
<hr>
</section>
<section id="set-directory-paths-and-initialize-data-structures" class="level3">
<h3 class="anchored" data-anchor-id="set-directory-paths-and-initialize-data-structures">Set Directory Paths and Initialize Data Structures</h3>
<p><em>Here, we specify the directory paths where the text files are located and initialize data structures for storing the text data. The <code>directory_path</code> variable holds the path to the directory containing the text files. We also initialize an empty list <code>data</code> to store the text information and a counter <code>unique_id</code> for assigning unique identifiers to each text.</em></p>
<div id="8e68ae54" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Directory containing text files</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>directory_path <span class="op">=</span> <span class="st">'/content/osm-cca-nlp/res'</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>directory_path <span class="op">=</span> <span class="st">'/home/sol-nhl/rnd/d/quarto/osm-cca-nlp/res'</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the data</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a unique ID counter</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>unique_id <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>The <code>os</code> module functions will later use <code>directory_path</code> to access the files. The <code>unique_id</code> will increment for each file, ensuring each text has a unique identifier.</em></p>
<hr>
</section>
<section id="read-and-clean-text-files" class="level3">
<h3 class="anchored" data-anchor-id="read-and-clean-text-files">Read and Clean Text Files</h3>
<p><em>In this section, we iterate over the text files in the specified directory, read their contents, clean the text using the <code>clean_text</code> function, and store the data in the <code>data</code> list. The <code>os.listdir</code> function lists all files in the directory, and <code>os.path.join</code> constructs the full file path.</em></p>
<div id="6b0c40d2" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the text files in the directory</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> filename <span class="kw">in</span> os.listdir(directory_path):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Consider only plain text files</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filename.endswith(<span class="st">".txt"</span>) <span class="kw">or</span> filename.endswith(<span class="st">".md"</span>):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        file_path <span class="op">=</span> os.path.join(directory_path, filename)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Read the file content</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(file_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>            text <span class="op">=</span> <span class="bu">file</span>.read()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Clean the text</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        cleaned_text <span class="op">=</span> clean_text(text)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append the data as a dictionary with a unique ID</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        data.append({</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">'id'</span>: unique_id,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">'filename'</span>: filename,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">'original_text'</span>: text,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">'cleaned_text'</span>: cleaned_text</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Increment the unique ID</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        unique_id <span class="op">+=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>We use <code>open</code> with <code>encoding='utf-8'</code> to read the files, ensuring that UTF-8 characters are handled correctly. The cleaned text and metadata are stored as dictionaries in the <code>data</code> list.</em></p>
<hr>
</section>
<section id="create-and-save-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="create-and-save-dataframe">Create and Save DataFrame</h3>
<p><em>We convert the collected data into a Pandas DataFrame for easier manipulation and analysis. We then save this DataFrame as a TSV (Tab-Separated Values) file using the <code>to_csv</code> method with <code>sep='\t'</code>. The <code>index=False</code> parameter ensures that the DataFrame index is not included in the output file.</em></p>
<div id="125a32fe" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Pandas DataFrame</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>text_df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the DataFrame as a TSV file in the 'csv' subdirectory</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>output_file_path <span class="op">=</span> <span class="st">'/content/osm-cca-nlp/csv/text_data.tsv'</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>output_file_path <span class="op">=</span> <span class="st">'/home/sol-nhl/rnd/d/quarto/osm-cca-nlp/csv/text_data.tsv'</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the DataFrame to a TSV file</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>text_df.to_csv(output_file_path, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the DataFrame</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(text_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id                                           filename  \
0   1  strategy-sustainable-development-lund-universi...   
1   2          lu-sustainability-communication-01-min.md   

                                       original_text  \
0  Page 1\n\nSTRATEGY  \n\n19 September 2019  \n\...   
1  Your browser has javascript turned off or bloc...   

                                        cleaned_text  
0  Page 1\n\nSTRATEGY  \n\n19 September 2019  \n\...  
1  Your browser has javascript turned off or bloc...  </code></pre>
</div>
</div>
<p><em>This step utilizes Pandas’ data handling capabilities to structure our text data effectively and save it for future use.</em></p>
<hr>
</section>
<section id="load-spacy-model" class="level3">
<h3 class="anchored" data-anchor-id="load-spacy-model">Load spaCy Model</h3>
<p><em>We load a spaCy language model to perform natural language processing tasks. The <code>spacy.load</code> function loads the specified model into memory. In this case, we use the small English model <code>en_core_web_sm</code>.</em></p>
<div id="c79df955" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the spaCy model (small English model is used here)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>The loaded <code>nlp</code> object provides access to spaCy’s powerful NLP features, including tokenization, part-of-speech tagging, and sentence segmentation.</em></p>
<hr>
</section>
<section id="compute-text-statistics" class="level3">
<h3 class="anchored" data-anchor-id="compute-text-statistics">Compute Text Statistics</h3>
<p><em>We calculate word counts, character counts, and sentence counts for each cleaned text in the DataFrame. Pandas’ <code>apply</code> function applies a lambda function to each row in the <code>cleaned_text</code> column. For sentence counting, we use spaCy’s sentence segmentation by processing the text with <code>nlp</code> and accessing the <code>.sents</code> attribute.</em></p>
<div id="a28633b9" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform word count and character count on each cleaned text in the DataFrame</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>text_df[<span class="st">'word_count'</span>] <span class="op">=</span> text_df[<span class="st">'cleaned_text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">len</span>(x.split()))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>text_df[<span class="st">'character_count'</span>] <span class="op">=</span> text_df[<span class="st">'cleaned_text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">len</span>(x))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform sentence count using spaCy</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>text_df[<span class="st">'sentence_count'</span>] <span class="op">=</span> text_df[<span class="st">'cleaned_text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">len</span>(<span class="bu">list</span>(nlp(x).sents)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>The <code>len(x.split())</code> calculates the number of words by splitting the text on whitespace. The character count is obtained with <code>len(x)</code>. For sentence count, we process the text with the spaCy model and convert the <code>sents</code> generator to a list to count the sentences.</em></p>
<hr>
</section>
<section id="display-dataframe-with-selected-columns" class="level3">
<h3 class="anchored" data-anchor-id="display-dataframe-with-selected-columns">Display DataFrame with Selected Columns</h3>
<p><em>Finally, we display the DataFrame, excluding the ‘original_text’ and ‘cleaned_text’ columns for brevity. The <code>columns.difference</code> function identifies columns to exclude, and we use this to select the remaining columns for display.</em></p>
<div id="83baf900" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select and print all columns except 'original_text' and 'cleaned_text'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>columns_to_display <span class="op">=</span> text_df.columns.difference([<span class="st">'original_text'</span>, <span class="st">'cleaned_text'</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(text_df[columns_to_display])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   character_count                                           filename  id  \
0            13359  strategy-sustainable-development-lund-universi...   1   
1             9778          lu-sustainability-communication-01-min.md   2   

   sentence_count  word_count  
0              83        1848  
1              80        1073  </code></pre>
</div>
</div>
<p><em>This step showcases the metadata and statistical information we’ve gathered, such as the unique ID, filename, word count, character count, and sentence count, without displaying the potentially lengthy text content.</em></p>
<hr>
<p><strong>Summary:</strong></p>
<ul>
<li><strong>os module:</strong> Used for interacting with the operating system, listing directory contents, and constructing file paths.</li>
<li><strong>re module:</strong> Provides regular expression matching operations for text cleaning (though in this code, the regex is commented out).</li>
<li><strong>pandas:</strong> Used for creating and manipulating the DataFrame to store text data and computed statistics.</li>
<li><strong>spacy:</strong> Provides advanced NLP capabilities; we load a language model to perform sentence segmentation for counting sentences.</li>
<li><strong>apply and lambda functions in pandas:</strong> Used to apply functions to DataFrame columns for calculating word counts, character counts, and sentence counts.</li>
</ul>
<p>This modular approach allows for easy understanding and maintenance of the code, with each section handling a specific part of the text processing pipeline.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>